-- DH Boot Loader Library (Medium Window Dark Style)
local DHBootLoader = {}

local TweenService = game:GetService("TweenService")

-- ฟังก์ชันสร้าง Boot UI
function DHBootLoader:Show(config)
    local player = game.Players.LocalPlayer
    
    -- Config ที่ปรับแต่งได้
    config = config or {}
    local titleLeft = config.titleLeft or "DH V3"
    local titleRight = config.titleRight or "BR"
    local logoLeft = config.logoLeft or "D"
    local logoRight = config.logoRight or "H"
    local bootLogs = config.bootLogs or {
        {text = "CATCHING IMAGES.....", delay = 0.9},
        {text = "READING CONFIG FILES..", delay = 0.9},
        {text = "LOADING UI MODULES.....", delay = 0.9},
        {text = "BOOTING DH.........", delay = 1.2}
    }
    local onComplete = config.onComplete or function() end
    
    -- ScreenGui
    local gui = Instance.new("ScreenGui")
    gui.Name = "DH_BootUI"
    gui.Parent = player:WaitForChild("PlayerGui")
    gui.IgnoreGuiInset = true
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Global

    -- Main Window Frame
    local mainFrame = Instance.new("Frame", gui)
    mainFrame.Size = UDim2.new(0, 450, 0, 350)
    mainFrame.Position = UDim2.new(0.5, -225, 0.5, -175)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    mainFrame.BorderSizePixel = 0
    mainFrame.BackgroundTransparency = 1

    local corner = Instance.new("UICorner", mainFrame)
    corner.CornerRadius = UDim.new(0, 8)

    -- Header Bar
    local headerBar = Instance.new("Frame", mainFrame)
    headerBar.Size = UDim2.new(1, 0, 0, 40)
    headerBar.Position = UDim2.new(0, 0, 0, 0)
    headerBar.BackgroundColor3 = Color3.fromRGB(35, 35, 42)
    headerBar.BorderSizePixel = 0

    local headerCorner = Instance.new("UICorner", headerBar)
    headerCorner.CornerRadius = UDim.new(0, 8)

    local headerBottom = Instance.new("Frame", headerBar)
    headerBottom.Size = UDim2.new(1, 0, 0, 8)
    headerBottom.Position = UDim2.new(0, 0, 1, -8)
    headerBottom.BackgroundColor3 = Color3.fromRGB(35, 35, 42)
    headerBottom.BorderSizePixel = 0

    -- Header Left Text
    local headerLeft = Instance.new("TextLabel", headerBar)
    headerLeft.Size = UDim2.new(0, 200, 1, 0)
    headerLeft.Position = UDim2.new(0, 15, 0, 0)
    headerLeft.BackgroundTransparency = 1
    headerLeft.Text = titleLeft
    headerLeft.Font = Enum.Font.Code
    headerLeft.TextSize = 24
    headerLeft.TextColor3 = Color3.fromRGB(160, 160, 170)
    headerLeft.TextXAlignment = Enum.TextXAlignment.Left

    -- Header Right Text
    local headerRight = Instance.new("TextLabel", headerBar)
    headerRight.Size = UDim2.new(0, 80, 1, 0)
    headerRight.Position = UDim2.new(1, -95, 0, 0)
    headerRight.BackgroundTransparency = 1
    headerRight.Text = titleRight
    headerRight.Font = Enum.Font.Code
    headerRight.TextSize = 20
    headerRight.TextColor3 = Color3.fromRGB(160, 160, 170)
    headerRight.TextXAlignment = Enum.TextXAlignment.Right

    -- Main Content Area
    local contentArea = Instance.new("Frame", mainFrame)
    contentArea.Size = UDim2.new(1, 0, 1, -40)
    contentArea.Position = UDim2.new(0, 0, 0, 40)
    contentArea.BackgroundTransparency = 1

    -- Logo Container
    local logoContainer = Instance.new("Frame", contentArea)
    logoContainer.Size = UDim2.new(1, 0, 0, 120)
    logoContainer.Position = UDim2.new(0, 0, 0, 40)
    logoContainer.BackgroundTransparency = 1

    local logoX = Instance.new("TextLabel", logoContainer)
    logoX.Size = UDim2.new(0, 100, 1, 0)
    logoX.Position = UDim2.new(0.5, -80, 0, 0)
    logoX.BackgroundTransparency = 1
    logoX.Text = logoLeft
    logoX.Font = Enum.Font.GothamBold
    logoX.TextSize = 80
    logoX.TextColor3 = Color3.fromRGB(140, 140, 150)
    logoX.TextXAlignment = Enum.TextXAlignment.Center

    local logo3 = Instance.new("TextLabel", logoContainer)
    logo3.Size = UDim2.new(0, 100, 1, 0)
    logo3.Position = UDim2.new(0.5, -20, 0, 0)
    logo3.BackgroundTransparency = 1
    logo3.Text = logoRight
    logo3.Font = Enum.Font.GothamBold
    logo3.TextSize = 80
    logo3.TextColor3 = Color3.fromRGB(140, 100, 255)
    logo3.TextXAlignment = Enum.TextXAlignment.Center

    -- Boot Log Container
    local logContainer = Instance.new("Frame", contentArea)
    logContainer.Size = UDim2.new(1, -40, 0, 140)
    logContainer.Position = UDim2.new(0, 20, 0, 170)
    logContainer.BackgroundTransparency = 1

    local logList = Instance.new("UIListLayout", logContainer)
    logList.Padding = UDim.new(0, 8)
    logList.SortOrder = Enum.SortOrder.LayoutOrder
    logList.HorizontalAlignment = Enum.HorizontalAlignment.Left

    -- ฟังก์ชันเพิ่ม log
    local function addLog(text, delayTime)
        local logFrame = Instance.new("Frame", logContainer)
        logFrame.Size = UDim2.new(1, 0, 0, 20)
        logFrame.BackgroundTransparency = 1

        local function createText(txt, pos, color)
            local lbl = Instance.new("TextLabel", logFrame)
            lbl.Size = UDim2.new(0, 40, 1, 0)
            lbl.Position = UDim2.new(0, pos, 0, 0)
            lbl.BackgroundTransparency = 1
            lbl.Text = txt
            lbl.Font = Enum.Font.Code
            lbl.TextSize = 14
            lbl.TextColor3 = color or Color3.fromRGB(120,120,130)
            lbl.TextTransparency = 1
            lbl.TextXAlignment = Enum.TextXAlignment.Left
            return lbl
        end

        local parts = {
            createText("[",0,Color3.fromRGB(100,100,110)),
            createText("N",15,Color3.fromRGB(140,100,255)),
            createText("]",30,Color3.fromRGB(100,100,110)),
            createText(">",55,Color3.fromRGB(100,100,110)),
            createText(text,80,Color3.fromRGB(120,120,130))
        }

        for _,lbl in ipairs(parts) do
            TweenService:Create(lbl,TweenInfo.new(0.2),{TextTransparency=0}):Play()
            task.wait(0.03)
        end
        task.wait(delayTime or 0.8)
    end

    -- เริ่มต้นซ่อน UI ทั้งหมด
    for _, child in pairs(mainFrame:GetDescendants()) do
        if child:IsA("TextLabel") then
            child.TextTransparency = 1
        end
    end

    -- แสดง Animation
    task.spawn(function()
        -- Fade in
        TweenService:Create(mainFrame,TweenInfo.new(0.5,Enum.EasingStyle.Back),{BackgroundTransparency=0}):Play()
        TweenService:Create(headerBar,TweenInfo.new(0.5),{BackgroundTransparency=0}):Play()
        TweenService:Create(headerBottom,TweenInfo.new(0.5),{BackgroundTransparency=0}):Play()

        task.wait(0.3)
        TweenService:Create(headerLeft,TweenInfo.new(0.3),{TextTransparency=0}):Play()
        TweenService:Create(headerRight,TweenInfo.new(0.3),{TextTransparency=0}):Play()

        task.wait(0.5)
        TweenService:Create(logoX,TweenInfo.new(0.8),{TextTransparency=0}):Play()
        task.wait(0.2)
        TweenService:Create(logo3,TweenInfo.new(0.8),{TextTransparency=0}):Play()

        task.wait(1)
        
        -- Boot sequence
        for _, log in ipairs(bootLogs) do
            addLog(log.text, log.delay)
        end

        print("DH System Ready")

        -- Fade out
        task.wait(1)
        local fadeOutTween = TweenService:Create(mainFrame,TweenInfo.new(1),{
            BackgroundTransparency = 1,
            Position = UDim2.new(0.5,-225,0.5,-200)
        })

        for _, child in pairs(mainFrame:GetDescendants()) do
            if child:IsA("TextLabel") then
                TweenService:Create(child,TweenInfo.new(1),{TextTransparency=1}):Play()
            elseif child:IsA("Frame") and child ~= mainFrame and child.BackgroundTransparency < 1 then
                TweenService:Create(child,TweenInfo.new(1),{BackgroundTransparency=1}):Play()
            end
        end

        fadeOutTween:Play()
        fadeOutTween.Completed:Wait()
        gui:Destroy()
        
        -- เรียก callback เมื่อเสร็จ
        onComplete()
    end)
    
    return gui
end

return DHBootLoader
